<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://bindster.com" xmlns:fb="http://ogp.me/ns/fb#" xml:lang="en" lang="en">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="description" content="Amorphic sample application">
    <meta name="keywords" content="amorphic nodejs mongodb">
    <meta name="title" content="Amorphic sample application">
    <title> Amorphic Ticket Demo </title>

    <link href="css/bootstrap.min.css" rel="stylesheet"></link>

    <!-- First include your library files -->
    <script src="modules/q/q.js?ver=0q.js?ver=0"></script>
    <script src="js/lib/underscore.js?ver=0"></script>

    <!-- Bootstrap -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <script src="js/lib/jquery.js"></script>
    <script src="js/lib/bootstrap.min.js"></script>
    <script src="//unpkg.com/vue"></script>

    <!-- Then include the amorphic files -->
    <script src="supertype/index.js?ver=0"></script>
    <script src="semotus/index.js?ver=0"></script>
    <script src="amorphic/client.js?ver=0"></script>
    <script src="modules/amorphic-bindster/index.js?ver=1"></script>
    <script src="modules/amorphic-bindster/router.js?ver=0"></script>


    <script src="js/router.js?ver=0"></script>
    <!-- Dynamically generated script that will contain the controller and related objects -->
    <script src="amorphic/init/ticket.js?ver=0"></script>

</head>

<body style="visibility:hidden;">
<div id="vue-app">
    <!--#include virtual="inc/mappers.html" -->
    <!--#include virtual="inc/messages.html" -->

    <vue-menu></vue-menu>

    <div class="container" id="container" style="margin-top: 50px">

        <!-- HOME PAGE GOES HERE WHERE SEARCH ENGINES WILL SEE IT -->

        <b:if test="!file">

            <div b:showif="loggedIn" class="page-header">

                <h1>Hey <span b:bind="loggedInPerson.firstName"></span></h1>
                <p>
                    Welcome to the Amorphic Ticket Demo
                </p>

            </div>

            <div b:showif="!loggedIn" class="page-header">
                <h1>Welcome to the Amorphic Ticket Demo</h1>
                <p>
                    Amorphic is an open source project on
                    <a href="https://github.com/selsamman/amorphic" target="_blank">github</a>
                </p>
            </div>

            <div style="text-align: center;color: red;margin-top: 20px" b:bind="error"></div>

        </b:if>

        <b:if test="file">
            <b:include url="{file}"></b:include>
        </b:if>

    </div>
</div> <!--close #vue-app -->
    <!--#include virtual="inc/mocha.html" -->
    <script src="modules/amorphic-bindster/bindster-amorphic.js"></script>
    <!-- Vue Templates -->
    <script type="text/x-template" id="vue-menu-tpl">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <ul class="nav navbar-nav" v-show="!isLoggedIn">
                <li><a href="#" @click.prevent="goHome">Home</a></li>
                <li><a href="#" @click.prevent="goLogin">Login</a></li>
                <li><a href="#" @click.prevent="goRegistration">Register</a></li>
                <li><a href="#" @click.prevent="doTests">Tests</a></li>
            </ul>
            <ul class="nav navbar-nav" v-show="isLoggedIn">
                <li><a href="#" @click.prevent="goHome">Home</a></li>
                <li><a href="#" @click.prevent="goTickets">Tickets</a></li>
                <li><a href="#" @click.prevent="goProjects">Projects</a></li>
                <li><a href="#" @click.prevent="goPeople">People</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hello <span>{{userFirstName}}</span><b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="#" @click.prevent="doLogout">Logout</a></li>
                        <li><a href="#" @click.prevent="goChangeEmail">Change email</a></li>
                        <li><a href="#" @click.prevent="goPassword">Change Password</a></li>
                        <li><a href="#" @click.prevent="doDeleteAll">Clear Database</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </script>
    <!-- Vue Components -->
    <script>
        Vue.component('VueMenu', {
            template: '#vue-menu-tpl',
            computed: {
                isLoggedIn: function(){
                    return controller.isLoggedIn();
                },
                userFirstName: function(){
                    return controller.loggedInPerson.firstName;
                }
            },
            methods: {
                goHome: function(e){
                    controller.route.public.home();
                },
                goLogin: function(e){
                    controller.route.public.login();
                },
                goRegistration: function(e){
                    controller.route.public.registration();
                },
                goTickets: function(e){
                    controller.route.private.tickets();
                },
                goProjects: function(e){
                    controller.route.private.projects();
                },
                goPeople: function(e){
                    controller.route.private.people();
                },
                goChangeEmail: function(e){
                    controller.route.public.change_email();
                },
                goPassword: function(e){
                    controller.route.public.change_password();
                },
                doTests: function(e){
                    controller.runTests();
                },
                doLogout: function(e){
                    controller.logout();
                },
                doDeleteAll: function(e){
                    controller.deleteAll();
                }
            }
        });
        var app = new Vue({ el: '#vue-app' });
    </script>
</body>
</html>